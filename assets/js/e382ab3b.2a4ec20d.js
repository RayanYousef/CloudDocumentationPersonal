"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[975],{7046(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"reference/workflows","title":"Workflows Reference","description":"This section contains the reference for the GitHub Actions workflows.","source":"@site/docs/reference/workflows.md","sourceDirName":"reference","slug":"/reference/workflows","permalink":"/CloudDocumentationPersonal/reference/workflows","draft":false,"unlisted":false,"editUrl":"https://github.com/RayanYousef/CloudDocumentationPersonal/edit/main/website/docs/reference/workflows.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Scripts Reference","permalink":"/CloudDocumentationPersonal/reference/scripts"}}');var s=i(4848),o=i(8453);const r={},a="Workflows Reference",l={},d=[{value:"Main Controller",id:"main-controller",level:2},{value:"Android AAB Store",id:"android-aab-store",level:2},{value:"Android APK Drive",id:"android-apk-drive",level:2},{value:"iOS IPA TestFlight",id:"ios-ipa-testflight",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"workflows-reference",children:"Workflows Reference"})}),"\n",(0,s.jsx)(n.p,{children:"This section contains the reference for the GitHub Actions workflows."}),"\n",(0,s.jsx)(n.h2,{id:"main-controller",children:"Main Controller"}),"\n",(0,s.jsx)(n.p,{children:"The main controller workflow that orchestrates the builds."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"/CloudDocumentationPersonal/downloads/workflows/main-controller.yml",children:"Download main-controller.yml"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"name: Build Controller\n\non:\n  workflow_dispatch:\n    inputs:\n      run_android_aab_store:\n        description: 'Run Android AAB (upload to Play)'\n        required: false\n        type: boolean\n        default: false\n      run_android_apk_gdrive:\n        description: 'Run Android APK (upload to Drive)'\n        required: false\n        type: boolean\n        default: false\n      run_ios_ipa_testflight:\n        description: 'Run iOS IPA (upload to TestFlight)'\n        required: false\n        type: boolean\n        default: false\n      ios_upload_artifact:\n        description: 'Upload iOS build artifact (when running iOS)'\n        required: false\n        type: boolean\n        default: false\n\njobs:\n  run-android-aab-store:\n    if: ${{ github.event.inputs.run_android_aab_store == 'true' }}\n    uses: ./reference/workflowsandroid-aab-store.yml\n    secrets: inherit\n\n  run-android-apk-gdrive:\n    if: ${{ github.event.inputs.run_android_apk_gdrive == 'true' }}\n    uses: ./reference/workflowsandroid-apk-gdrive.yml\n    secrets: inherit\n\n  run-ios-ipa-testflight:\n    if: ${{ github.event.inputs.run_ios_ipa_testflight == 'true' }}\n    uses: ./reference/workflows#ios-ipa-testflight\n    with:\n      upload_artifact: ${{ github.event.inputs.ios_upload_artifact == 'true' }}\n    secrets: inherit\n\n\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"android-aab-store",children:"Android AAB Store"}),"\n",(0,s.jsx)(n.p,{children:"Workflow to build Android App Bundle and upload to Play Store."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"/CloudDocumentationPersonal/downloads/workflows/android-aab-store.yml",children:"Download android-aab-store.yml"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"name: ToStore - Automated Build - Android\n\non:\n  workflow_dispatch:\n  workflow_call:\n\nenv:\n  UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }}\n\njobs:\n  buildAndroid:\n    name: Build for Android \ud83d\udda5\ufe0f\n    runs-on: ubuntu-22.04\n    timeout-minutes: 220\n    strategy:\n      fail-fast: false\n    steps:\n      - name: Delete huge unnecessary tools folder\n        run: rm -rf /opt/hostedtoolcache\n\n      - name: Free Disk Space (Ubuntu)\n        uses: jlumbroso/free-disk-space@main # https://github.com/jlumbroso/free-disk-space\n        with:\n          # this might remove tools that are actually needed,\n          # if set to \"true\" but frees about 6 GB\n          tool-cache: false\n\n          # all of these default to true, but feel free to set to\n          # \"false\" if necessary for your workflow\n          android: false\n          dotnet: false\n          haskell: true\n          large-packages: true\n          docker-images: true\n          swap-storage: false\n\n      - name: Checkout code\n        uses: actions/checkout@v4 # https://github.com/actions/checkout\n        with:\n         # ref: main\n         lfs: true\n\n      - name: Create LFS file list\n        run: git lfs ls-files -l | cut -d' ' -f1 | sort > .lfs-assets-id\n\n      - name: Restore LFS cache\n        uses: actions/cache@v4 # https://github.com/actions/cache\n        id: lfs-cache\n        with:\n          path: .git/lfs\n          key: ${{ runner.os }}-lfs-${{ hashFiles('.lfs-assets-id') }}\n\n      - name: Git LFS Pull\n        run: |\n          git lfs pull\n          git add .\n          git reset --hard\n      - name: Restore Library cache\n        uses: actions/cache@v4 # https://github.com/actions/cache\n        with:\n          path: SkrewClient/Library\n          key: Library-build-Android\n          restore-keys: |\n            Library-build-Android\n            Library-build-\n            Library-\n\n      - uses: game-ci/unity-builder@v4.3.0 # https://github.com/game-ci/unity-builder\n        id: myBuildStep\n        env:\n          UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }}\n          UNITY_EMAIL: ${{ secrets.UNITY_EMAIL }}\n          UNITY_PASSWORD: ${{ secrets.UNITY_PASSWORD }}\n        with:\n          projectPath: ./SkrewClient\n          targetPlatform: Android\n          androidExportType: 'androidAppBundle'\n          buildName: Build_Android_auto\n          versioning : None\n          androidVersionCode : 4\n          androidKeystorePass: ${{ secrets.ANDROID_KEYSTORE_PASS }}\n          androidKeyaliasPass: ${{ secrets.ANDROID_KEYALIAS_PASS }}\n\n      - name: check folders (can be removed)\n        run: |\n          ls -a\n          cd build\n          ls -a\n          cd Android\n          ls -a\n\n      - name: JSON to variables\n        uses: rgarcia-phi/json-to-variables@v1.1.0 # https://github.com/rgarcia-phi/json-to-variables\n        with:\n          filename: 'CloudBuild/VersioningSettings.json'\n          prefix: setting\n\n      - uses: r0adkll/upload-google-play@v1.1.3 # https://github.com/r0adkll/upload-google-play\n        with:\n          serviceAccountJsonPlainText: ${{ secrets.SERVICE_ACCOUNT_JSON }}\n          packageName: com.yamp.skrew                                 #Change package name when changing project\n          releaseFiles: build/Android/Build_Android_auto.aab\n          whatsNewDirectory: CloudBuild/WhatsNew\n          track: internal\n          status: draft\n          releaseName: v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }}\n\n  notifyAAB:\n    permissions: read-all\n    name: Discord Notification for AAB Build\n    runs-on: ubuntu-latest\n    needs:\n      - buildAndroid\n    if: ${{ success() || failure() }}\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: JSON to variables (for release name)\n        uses: rgarcia-phi/json-to-variables@v1.1.0\n        with:\n          filename: 'CloudBuild/VersioningSettings.json'\n          prefix: setting\n\n      - name: Notify AAB Build\n        uses: nobrayner/discord-webhook@v1 # https://github.com/nobrayner/discord-webhook\n        with:\n          github-token: ${{ secrets.GITHUB_TOKEN }}\n          discord-webhook: ${{ secrets.DISCORD_WEBHOOK_SKREW }}\n          username: 'Build Notifier'\n          include-details: true\n          title: 'AAB Build and Upload to Google Play'\n          description: 'The AAB has been uploaded to Google Play. Release: v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }} | File: Build_Android_auto.aab'\n\n\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"android-apk-drive",children:"Android APK Drive"}),"\n",(0,s.jsx)(n.p,{children:"Workflow to build Android APK and upload to Google Drive."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"/CloudDocumentationPersonal/downloads/workflows/android-apk-gdrive.yml",children:"Download android-apk-gdrive.yml"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"name: ToDrive - APK Build and Upload - Android\n\non:\n  workflow_dispatch:\n  workflow_call:\n\nenv:\n  UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }}\n\njobs:\n  buildAPK:\n    name: Build APK for Android \ud83d\udda5\ufe0f\n    runs-on: ubuntu-22.04\n    timeout-minutes: 220\n    strategy:\n      fail-fast: false\n    steps:\n      - name: Delete huge unnecessary tools folder\n        run: rm -rf /opt/hostedtoolcache\n\n      - name: Free Disk Space (Ubuntu)\n        uses: jlumbroso/free-disk-space@main # https://github.com/jlumbroso/free-disk-space\n        with:\n          tool-cache: false\n\n          android: false\n          dotnet: false\n          haskell: true\n          large-packages: true\n          docker-images: true\n          swap-storage: false\n\n      - name: Checkout code\n        uses: actions/checkout@v4 # https://github.com/actions/checkout\n        with:\n         # ref: main\n         lfs: true\n\n      - name: Create LFS file list\n        run: git lfs ls-files -l | cut -d' ' -f1 | sort > .lfs-assets-id\n\n      - name: Restore LFS cache\n        uses: actions/cache@v4 # https://github.com/actions/cache\n        id: lfs-cache\n        with:\n          path: .git/lfs\n          key: ${{ runner.os }}-lfs-${{ hashFiles('.lfs-assets-id') }}\n\n      - name: Git LFS Pull\n        run: |\n          git lfs pull\n          git add .\n          git reset --hard\n      - name: Restore Library cache\n        uses: actions/cache@v4 # https://github.com/actions/cache\n        with:\n          path: SkrewClient/Library\n          key: Library-build-Android-APK\n          restore-keys: |\n            Library-build-Android-APK\n            Library-build-\n            Library-\n\n      - name: JSON to variables\n        uses: rgarcia-phi/json-to-variables@v1.1.0 # https://github.com/rgarcia-phi/json-to-variables\n        with:\n          filename: 'CloudBuild/VersioningSettings.json'\n          prefix: setting\n\n      - uses: game-ci/unity-builder@v4.3.0 # https://github.com/game-ci/unity-builder\n        env:\n          UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }}\n          UNITY_EMAIL: ${{ secrets.UNITY_EMAIL }}\n          UNITY_PASSWORD: ${{ secrets.UNITY_PASSWORD }}\n        with:\n          projectPath: ./SkrewClient\n          targetPlatform: Android\n          androidExportType: 'androidPackage'\n          buildName: v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }}\n          versioning : None\n          androidVersionCode : 4\n          androidKeystorePass: ${{ secrets.ANDROID_KEYSTORE_PASS }}\n          androidKeyaliasPass: ${{ secrets.ANDROID_KEYALIAS_PASS }}\n\n      - name: Upload Build Artifact\n        uses: actions/upload-artifact@v4 # https://github.com/actions/upload-artifact\n        with:\n          name: Android-APK\n          path: build/Android/v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }}.apk\n\n  uploadToDrive:\n    name: Upload to Google Drive\n    runs-on: ubuntu-latest\n    needs: buildAPK\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: JSON to variables\n        uses: rgarcia-phi/json-to-variables@v1.1.0\n        with:\n          filename: 'CloudBuild/VersioningSettings.json'\n          prefix: setting\n\n      - name: Download the Build Artifact\n        uses: actions/download-artifact@v4 # https://github.com/actions/download-artifact\n        with:\n          name: Android-APK\n          path: ./BuildData\n\n      - name: run singleLine\n        run: |\n            ls -a\n            cd BuildData\n            ls -a\n\n      - name: Verify the artifact download\n        run: ls -l ./BuildData/v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }}.apk\n\n      - name: Upload Build to Google Drive\n        uses: Jumbo810/Upload_Github_Artifacts_TO_GDrive@v2.3.1 # https://github.com/Jumbo810/Upload_Github_Artifacts_TO_GDrive\n        with:\n          target: ./BuildData/v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }}.apk\n          credentials: ${{ secrets.GOOGLE_SERVICE_ACCOUNT_CREDENTIALS }}\n          parent_folder_id: ${{ vars.GOOGLE_DRIVE_PARENT_FOLDER_ID }}\n\n  notifyAPK:\n    permissions: read-all\n    name: Discord Notification for APK Build\n    runs-on: ubuntu-latest\n    needs:\n      - uploadToDrive\n    if: ${{ success() || failure() }}\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: JSON to variables (for build name)\n        uses: rgarcia-phi/json-to-variables@v1.1.0\n        with:\n          filename: 'CloudBuild/VersioningSettings.json'\n          prefix: setting\n\n      - name: Notify APK Build\n        uses: nobrayner/discord-webhook@v1 # https://github.com/nobrayner/discord-webhook\n        with:\n          github-token: ${{ secrets.GITHUB_TOKEN }}\n          discord-webhook: ${{ secrets.DISCORD_WEBHOOK_SKREW }}\n          username: 'Build Notifier'\n          include-details: true\n          title: 'APK Build and Upload to Google Drive'\n          description: 'The APK has been uploaded to Google Drive. Release: v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }} | File: v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildVersionAndroid }}.apk'\n\n\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"ios-ipa-testflight",children:"iOS IPA TestFlight"}),"\n",(0,s.jsx)(n.p,{children:"Workflow to build iOS IPA and upload to TestFlight."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"/CloudDocumentationPersonal/downloads/workflows/ios-ipa-testflight.yml",children:"Download ios-ipa-testflight.yml"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'name: ToStore - Automated Build - IOS\n\non:\n  #push:\n   # branches:\n   #   - master\n  workflow_dispatch:\n    inputs:\n      upload_artifact:\n        description: \'Upload iOS build artifact\'\n        required: false\n        type: boolean\n        default: true\n  workflow_call:\n    inputs:\n      upload_artifact:\n        required: false\n        type: boolean\n        default: true\n\nenv:\n  UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }}\n\njobs:\n  buildIOS:\n    name: Build xCode \ud83d\udda5\ufe0f\n    runs-on: ubuntu-latest\n    permissions: write-all\n    timeout-minutes: 120\n    strategy:\n      fail-fast: false\n    steps:\n      - name: Delete huge unnecessary tools folder\n        run: rm -rf /opt/hostedtoolcache\n\n      - name: Free Disk Space (Ubuntu)\n        uses: jlumbroso/free-disk-space@main # https://github.com/jlumbroso/free-disk-space\n        with:\n          # Set to "true" to remove cached tools like Go, Node.js, etc.\n          # Frees ~6 GB. Recommended unless your build specifically needs these pre-cached tools.\n          tool-cache: true\n\n          # Set to "true" to remove Android SDKs/NDKs.\n          # Recommended for iOS builds as these are not needed and take up significant space.\n          # Default is true, but explicitly set to \'false\' here. Consider changing to \'true\'.\n          android: false\n\n          # Set to "true" to remove .NET SDKs.\n          # Unity uses .NET, but often bundles its own runtime. Removing system .NET is usually safe.\n          # Keep as "false" only if you are certain your build depends on the pre-installed .NET SDKs.\n          # Default is true.\n          dotnet: true\n\n          # Set to "true" to remove Haskell tools (GHC, Cabal).\n          # Unnecessary for Unity/iOS builds. Recommended to keep "true".\n          # Default is true.\n          haskell: true\n\n          # Set to "true" to remove large packages like CodeQL, firefox, google-chrome.\n          # Unlikely needed for a Unity build. Recommended to keep "true" for more space.\n          # Default is true.\n          large-packages: true\n\n          # Set to "true" to remove cached Docker images.\n          # Unnecessary unless your build process uses Docker. Recommended to keep "true".\n          # Default is true.\n          docker-images: true\n\n          # Set to "true" to remove swap storage.\n          # Keeping swap ("false") is recommended to prevent potential out-of-memory errors during large builds.\n          # Default is true.\n          swap-storage: false\n\n      - name: Checkout code\n        uses: actions/checkout@v4 # https://github.com/actions/checkout\n        with:\n        #  ref: main\n         lfs: true\n\n      - name: Create LFS file list\n        run: git lfs ls-files -l | cut -d\' \' -f1 | sort > .lfs-assets-id\n\n      - name: Restore LFS cache\n        uses: actions/cache@v4 # https://github.com/actions/cache\n        id: lfs-cache\n        with:\n          path: .git/lfs\n          key: ${{ runner.os }}-lfs-${{ hashFiles(\'.lfs-assets-id\') }}\n\n      - name: Git LFS Pull\n        run: |\n          git lfs pull\n          git add .\n          git reset --hard\n      - name: Remove Android-specific plugins\n        run: |\n          rm -rf SkrewClient/Assets/ExternalDependencyManager\n          rm -rf SkrewClient/Assets/ExternalDependencyManager.meta\n          rm -rf SkrewClient/Assets/Firebase\n          rm -rf SkrewClient/Assets/Firebase.meta\n          rm -rf SkrewClient/Assets/GooglePlayGames\n          rm -rf SkrewClient/Assets/GooglePlayGames.meta\n      - name: Restore Library cache\n        uses: actions/cache@v4 # https://github.com/actions/cache\n        with:\n          path: SkrewClient/Library\n          key: Library-build-iOS\n          restore-keys: |\n            Library-build-iOS\n            Library-build-\n            Library-\n\n      - uses: game-ci/unity-builder@v4.3.0 # https://github.com/game-ci/unity-builder\n        id: myBuildStep\n        env:\n          UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }}\n          UNITY_EMAIL: ${{ secrets.UNITY_EMAIL }}\n          UNITY_PASSWORD: ${{ secrets.UNITY_PASSWORD }}\n        with:\n          projectPath: ./SkrewClient\n          targetPlatform: iOS\n          buildName: Build_iOS_auto\n          versioning: None\n          # versioning: Custom\n          # version: 1.0.${{ github.run_number }}\n          # allowDirtyBuild: true\n\n\n      - uses: actions/cache/save@v4 # https://github.com/actions/cache\n        id: cachesave\n        with:\n          path: build\n          key: Build_iOS_${{ github.run_id }}\n\n\n        # Uploading the Xcode project\n      - name: Upload iOS Build Artifact\n        if: ${{ inputs.upload_artifact || github.event.inputs.upload_artifact == \'true\' }}\n        uses: actions/upload-artifact@v4\n        with:\n          name: iOS-Build-Output\n          path: build/iOS/Build_iOS_auto\n\n  Mac-Xcode:\n    permissions: read-all\n    name: Archive and Upload\n    runs-on: macos-latest\n    needs:\n      - buildIOS\n    outputs:\n      ipa_path: ${{ steps.expose_ipa.outputs.ipa_path }}\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: JSON to variables (for naming)\n        uses: rgarcia-phi/json-to-variables@v1.1.0 # https://github.com/rgarcia-phi/json-to-variables\n        with:\n          filename: \'CloudBuild/VersioningSettings.json\'\n          prefix: setting\n\n      - uses: actions/cache/restore@v4 # https://github.com/actions/cache\n        id: cacheLoad\n        with:\n          path: build\n          key: Build_iOS_${{ github.run_id }}\n\n      - name: Clean DerivedData\n        run: rm -rf ~/Library/Developer/Xcode/DerivedData/*\n\n      - name: Install the Apple certificate and provisioning profile\n        env:\n          P12_PASSWORD: ${{ secrets.APNS_P12_PASSWORD }}\n          APPLE_DISTRIBUTION_P12_PASSWORD: ${{ secrets.APPLE_DISTRIBUTION_P12_PASSWORD }}\n          KEYCHAIN_PASSWORD: 123\n        run: |\n          # create variables\n          CERTIFICATE_PATH=CloudBuild/iOS/Certificates/Apple_Distribution.p12\n          APNS_CERTIFICATE_PATH=CloudBuild/iOS/Certificates/Skrew_APNS_Prod.p12\n          PP_PATH=CloudBuild/iOS/ProvisioningProfiles/\n          KEYCHAIN_PATH=$RUNNER_TEMP/app-signing.keychain-db\n\n          # create temporary keychain\n          security create-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH\n          security set-keychain-settings -lut 21600 $KEYCHAIN_PATH\n          security unlock-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH\n\n          # import certificate to keychain\n          security import $CERTIFICATE_PATH -P "$APPLE_DISTRIBUTION_P12_PASSWORD" -A -t cert -f pkcs12 -k $KEYCHAIN_PATH\n          security import $APNS_CERTIFICATE_PATH -P "$P12_PASSWORD" -A -t cert -f pkcs12 -k $KEYCHAIN_PATH\n          security set-key-partition-list -S apple-tool:,apple:,codesign: -s -k $KEYCHAIN_PASSWORD $KEYCHAIN_PATH\n          security list-keychain -d user -s $KEYCHAIN_PATH\n\n          # apply provisioning profile\n          echo "Current user: $(whoami)"\n\n          # Create both possible provisioning profile directories as fallback\n          mkdir -p ~/Library/Developer/Xcode/UserData/Provisioning\\ Profiles\n          mkdir -p ~/Library/MobileDevice/Provisioning\\ Profiles\n\n          # Copy to both locations to ensure compatibility\n          cp -R $PP_PATH* ~/Library/Developer/Xcode/UserData/Provisioning\\ Profiles/\n          cp -R $PP_PATH* ~/Library/MobileDevice/Provisioning\\ Profiles/\n\n          cd ~/Library/Developer/Xcode/UserData/Provisioning\\ Profiles\n          ls -a\n\n          echo "Checking MobileDevice directory:"\n          cd ~/Library/MobileDevice/Provisioning\\ Profiles\n          ls -a\n\n      - name: Check notificationservice folder\n        run: ls -la build/iOS/Build_iOS_auto/notificationservice/\n\n      - name: Install iOS 18.2 Platform\n        run: |\n          echo "Installing iOS 18.2 platform..."\n          sudo xcode-select -switch /Applications/Xcode_16.2.app\n          xcodebuild -downloadPlatform iOS -buildVersion 18.2 || echo "Platform download failed or already exists"\n          xcodebuild -showsdks | grep -i ios\n\n      - name: sign and archive\n        run: |\n          sudo xcode-select -switch /Applications/Xcode_16.2.app\n          # Code signing configuration is now handled automatically by Unity PostProcessBuild script\n          xcodebuild -configuration "Release" ENABLE_BITCODE=NO DEBUGGING_SYMBOLS=NO -project build/iOS/Build_iOS_auto/Unity-iPhone.xcodeproj -scheme Unity-iPhone -destination \'generic/platform=iOS\' -archivePath bb/build.xcarchive clean archive\n\n          # Exports the archive according to the export options specified by the plist\n          xcodebuild -exportArchive -archivePath bb/build.xcarchive -exportPath bb/build.ipa -exportOptionsPlist CloudBuild/iOS/exportOptions.plist\n\n      - name: Find IPA file\n        run: |\n          IPA_PATH=$(find bb/build.ipa -type f -name "*.ipa" -exec du -sh {} + | sort -rh | head -n1 | awk \'{print $2}\')\n          echo "IPA_PATH=$IPA_PATH" >> $GITHUB_ENV\n\n      - name: Expose IPA path output\n        id: expose_ipa\n        run: echo "ipa_path=${{ env.IPA_PATH }}" >> $GITHUB_OUTPUT\n\n      - name: List files for debugging\n        run: |\n          ls -a\n          cd bb\n          ls -a\n          cd build.ipa\n          ls -a\n\n      - name: \'Upload app to TestFlight\'\n        uses: apple-actions/upload-testflight-build@v1 # https://github.com/apple-actions/upload-testflight-build\n        with:\n          app-path: ${{ env.IPA_PATH }}\n          issuer-id: ${{ secrets.APPSTORE_ISSUER_ID }}\n          api-key-id: ${{ secrets.APPSTORE_KEY_ID }}\n          api-private-key: ${{ secrets.APPSTORE_P8 }}\n\n  notify:\n    permissions: read-all\n    name: Discord Notification\n    runs-on: ubuntu-latest\n    needs:\n      - buildIOS\n      - Mac-Xcode\n    if: ${{ success() || failure() }}\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4 # https://github.com/actions/checkout\n\n      - name: JSON to variables (for version)\n        uses: rgarcia-phi/json-to-variables@v1.1.0 # https://github.com/rgarcia-phi/json-to-variables\n        with:\n          filename: \'CloudBuild/VersioningSettings.json\'\n          prefix: setting\n\n      - name: Notify\n        uses: nobrayner/discord-webhook@v1 # https://github.com/nobrayner/discord-webhook\n        with:\n          github-token: ${{ secrets.GITHUB_TOKEN }}\n          discord-webhook: ${{ secrets.DISCORD_WEBHOOK_SKREW }}\n          username: \'Build Notifier\'\n          include-details: true\n          title: \'iOS Build and Upload to TestFlight\'\n          description: \'The IPA has been uploaded to TestFlight. Release: v${{ env.setting_AppVersion }}_bv${{ env.setting_BuildNumberIOS }} | File: ${{ needs.Mac-Xcode.outputs.ipa_path }}\'\n\n\n\n'})})]})}function c(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453(e,n,i){i.d(n,{R:()=>r,x:()=>a});var t=i(6540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);